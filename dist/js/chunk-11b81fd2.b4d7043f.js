(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-11b81fd2"],{"3b2d":function(e,t,a){"use strict";var i=a("9a24"),n=a.n(i);n.a},7744:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-row",[a("a-col",{attrs:{span:12}},[a("a-breadcrumb",{staticStyle:{margin:"10px 5px"}},[a("a-breadcrumb-item",[a("router-link",{attrs:{to:"/admins/list"}},[e._v(e._s(e.$t("admins")))])],1),a("a-breadcrumb-item",[e._v(e._s(e.$t("add")))])],1)],1)],1),a("a-card",{attrs:{title:e.$t("fillIn")}},[a("a-row",[a("v-main")],1)],1)],1)},n=[],s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-switch",{staticStyle:{margin:"15px 0"},attrs:{slot:"extra","checked-children":e.$t("active"),"un-checked-children":e.$t("inactive"),"default-checked":""},slot:"extra",model:{value:e.active,callback:function(t){e.active=t},expression:"active"}}),a("a-form-model",{ref:"ruleForm",attrs:{model:e.admin,rules:e.rules,"label-col":e.labelCol,"wrapper-col":e.wrapperCol},on:{submit:e.onSubmit}},[a("a-row",[a("a-tabs",{attrs:{type:"card"},model:{value:e.activeTabKey,callback:function(t){e.activeTabKey=t},expression:"activeTabKey"}},[a("a-tab-pane",{key:"1",attrs:{tab:e.$t("basicSettings")}},[a("a-col",{staticStyle:{padding:"0 15px"},attrs:{span:24}},[a("a-form-model-item",{ref:"name",attrs:{label:e.$t("firstName"),prop:"name"}},[a("a-input",{model:{value:e.admin.name,callback:function(t){e.$set(e.admin,"name",t)},expression:"admin.name"}})],1)],1),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{span:12}},[a("a-form-model-item",{ref:"username",attrs:{label:e.$t("username"),prop:"username"}},[a("a-input",{model:{value:e.admin.username,callback:function(t){e.$set(e.admin,"username",t)},expression:"admin.username"}})],1)],1),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{span:12}},[a("a-form-model-item",{ref:"phone",attrs:{label:e.$t("phone"),prop:"phone"}},[a("a-input",{attrs:{type:"tel"},model:{value:e.admin.phone,callback:function(t){e.$set(e.admin,"phone",t)},expression:"admin.phone"}})],1)],1),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{span:12}},[a("a-form-model-item",{ref:"password",attrs:{label:e.$t("password"),prop:"password"}},[a("a-input",{model:{value:e.admin.password,callback:function(t){e.$set(e.admin,"password",t)},expression:"admin.password"}})],1)],1),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{span:12}},[a("a-form-model-item",{ref:"confirmPassword",attrs:{label:e.$t("confirmPassword"),prop:"confirmPassword"}},[a("a-input",{model:{value:e.confirmPassword,callback:function(t){e.confirmPassword=t},expression:"confirmPassword"}})],1)],1),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{span:24}},[a("a-form-model-item",[a("a-button",{attrs:{type:"primary","html-type":"submit"},on:{click:e.onSubmit}},[e._v(" "+e._s(e.$t("save"))+" ")]),a("a-button",{staticStyle:{"margin-left":"10px"},on:{click:e.resetForm}},[e._v(" "+e._s(e.$t("reset"))+" ")])],1)],1)],1),this.permissionsVisibility?a("a-tab-pane",{key:"2",attrs:{tab:e.$t("permissions")}},[a("a-col",{attrs:{span:24}},[a("a-list",{attrs:{bordered:"","data-source":e.allPermissions},scopedSlots:e._u([{key:"renderItem",fn:function(t){return a("a-list-item",{},[e._v(" "+e._s(t.name)+" "),a("a-switch",{attrs:{slot:"extra"},on:{change:function(a){return e.handlePermissionChange(t.id)}},slot:"extra",model:{value:t.checked,callback:function(a){e.$set(t,"checked",a)},expression:"permission.checked"}},[a("a-icon",{attrs:{slot:"checkedChildren",type:"check"},slot:"checkedChildren"}),a("a-icon",{attrs:{slot:"unCheckedChildren",type:"close"},slot:"unCheckedChildren"})],1)],1)}}],null,!1,3050936826)})],1),a("router-link",{attrs:{to:"/admins/list"}},[a("a-button",{staticStyle:{"margin-top":"15px"},attrs:{type:"primary"}},[e._v(" "+e._s(e.$t("backToList"))+" ")])],1)],1):e._e()],1)],1)],1)],1)},r=[],o=(a("7db0"),a("d81d"),a("b0c0"),a("d3b7"),a("ac1f"),a("5319"),a("5530")),c=a("b775"),d=a("5880"),m={data:function(){return{adminId:this.$route.params.id,createMode:!this.$route.params.id,createdAdminId:null,labelCol:{span:24},wrapperCol:{span:24},activeTabKey:"1",loading:!1,active:!0,adminPermissions:null,allPermissions:null,permissionsVisibility:!1,confirmPassword:"",admin:{name:"",username:"",password:"",phone:""},rules:{name:[{required:!0,message:this.$t("required"),trigger:"change"}],username:[{required:!0,message:this.$t("required"),trigger:"change"}],phone:[{required:!0,message:this.$t("required"),trigger:"change"}],password:[{required:!this.$route.params.id,message:this.$t("required"),trigger:"change"},{min:4,message:this.$t("minLength"),trigger:"change"}]}}},mounted:function(){var e=this;this.adminId&&(this.permissionsVisibility=!0,this.getAdminAttrs(this.adminId).then((function(){e.getPermissions().then((function(){e.allPermissions=e.permissions&&e.permissions.map((function(t){return Object(o["a"])(Object(o["a"])({},t),{},{checked:e.checkPermission(t)})}))})).catch((function(e){}))})).catch((function(e){})))},computed:Object(o["a"])({},Object(d["mapGetters"])(["permissions"])),methods:Object(o["a"])(Object(o["a"])({},Object(d["mapActions"])(["getPermissions"])),{},{checkPermission:function(e){var t=this.adminPermissions&&this.adminPermissions.find((function(t){return t.key===e.key}));return!!t},handlePermissionChange:function(e,t){Object(c["b"])({url:"/admin/update-permission",method:"post",data:{admin_id:t||this.adminId,permission_id:e},headers:{"Content-Type":"application/json"}})},getAdminAttrs:function(e){var t=this;return new Promise((function(a,i){Object(c["b"])({url:"/admin/profile/".concat(e),method:"get"}).then((function(e){var i=e.id,n=e.name,s=e.username,r=e.active,o=e.phone,c=e.permissions;t.adminId=i,t.admin.name=n,t.admin.username=s,t.active=r,t.admin.phone=o,t.adminPermissions=c,a()})).catch((function(e){i()}))}))},onSubmit:function(e){var t=this;e.preventDefault(),this.$refs.ruleForm.validate((function(e){if(t.admin.password===t.confirmPassword){if(!e)return!1;var a="/admin",i="post";t.adminId&&(a="/admin/profile/".concat(t.adminId),i="put");var n={"Content-Type":"application/json"};Object(c["b"])({url:a,method:i,data:t.admin,headers:n}).then((function(e){if(t.createMode)return t.createdAdminId=e.id,t.permissionsVisibility=!0,t.activeTabKey="2",void t.getAdminAttrs(t.createdAdminId).then((function(){t.getPermissions().then((function(){t.allPermissions=t.permissions&&t.permissions.map((function(e){return"dashboard"===e.key?(t.handlePermissionChange(e.id,t.createdAdminId),Object(o["a"])(Object(o["a"])({},e),{},{checked:!0})):Object(o["a"])(Object(o["a"])({},e),{},{checked:t.checkPermission(e)})}))})).catch((function(e){}))})).catch((function(e){}));t.$router.replace("/admins/list")})).catch((function(e){t.$message.error(t.$t("error"))}))}else t.$message.error(t.$t("passwordMatchError"))}))},resetForm:function(){this.$refs.ruleForm.resetFields()}})},l=m,u=(a("3b2d"),a("2877")),p=Object(u["a"])(l,s,r,!1,null,null,null),h=p.exports,f={components:{"v-main":h}},b=f,g=Object(u["a"])(b,i,n,!1,null,null,null);t["default"]=g.exports},"9a24":function(e,t,a){}}]);