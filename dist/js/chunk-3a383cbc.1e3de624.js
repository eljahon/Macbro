(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3a383cbc"],{"79ff":function(t,e,a){},"886a":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-row",[a("a-col",{attrs:{span:12}},[a("a-breadcrumb",{staticStyle:{margin:"10px 5px"}},[a("a-breadcrumb-item",[a("router-link",{attrs:{to:"/catalog/products/list"}},[t._v(t._s(t.$t("products")))])],1),a("a-breadcrumb-item",[t._v(t._s(t.$t("add")))])],1)],1)],1),t.edit?a("div",[a("a-card",{attrs:{title:t.$t("fillIn")}},[a("a-row",[a("a-tabs",{attrs:{type:"card"},model:{value:t.activeTabKey,callback:function(e){t.activeTabKey=e},expression:"activeTabKey"}},t._l(t.langs,(function(e,r){return a("a-tab-pane",{key:r+1},[a("span",{attrs:{slot:"tab"},slot:"tab"},[a("flag",{attrs:{iso:t.flagMapper(e)}}),t._v(" "+t._s(t.langMapper(e))+" ")],1),a("v-main",{ref:e+"EditForm",refInFor:!0,attrs:{lang:e},on:{clickParent:t.clickParent}})],1)})),1)],1)],1)],1):a("div",[a("a-card",{attrs:{title:t.$t("fillIn")}},[a("a-row",[a("v-main",{ref:"createForm",on:{clickParent:t.clickParent}})],1)],1)],1),a("a-row",[a("a-col",{staticStyle:{padding:"15px 0"},attrs:{span:24}},[a("a-form-model-item",[a("a-button",{attrs:{loading:t.btnLoading,type:"primary","html-type":"submit"},on:{click:function(e){return e.preventDefault(),t.submit(e)}}},[t._v(" "+t._s(t.$t("save"))+" ")]),a("a-button",{staticStyle:{"margin-left":"10px"},on:{click:function(e){return e.preventDefault(),t.resetForm(e)}}},[t._v(" "+t._s(t.$t("reset"))+" ")])],1)],1)],1)],1)},o=[],i=(a("4160"),a("4fad"),a("07ac"),a("159b"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-switch",{staticStyle:{margin:"0 0 15px"},attrs:{slot:"extra","checked-children":t.$t("active"),"un-checked-children":t.$t("inactive")},slot:"extra",model:{value:t.product.active,callback:function(e){t.$set(t.product,"active",e)},expression:"product.active"}}),a("a-form-model",{ref:"ruleForm",attrs:{model:t.product,rules:t.rules,"label-col":t.labelCol,"wrapper-col":t.wrapperCol},on:{submit:t.onSubmit}},[a("a-tabs",{attrs:{type:"card"},on:{change:t.activeTabHandler},model:{value:t.activeTabKey,callback:function(e){t.activeTabKey=e},expression:"activeTabKey"}},[a("a-tab-pane",{key:"1",attrs:{tab:t.$t("basicSettings")}},[a("a-row",[a("a-col",{staticStyle:{padding:"0 15px"},attrs:{md:24,lg:8}},[a("a-form-model-item",{ref:"name",attrs:{label:t.$t("product_name"),prop:"name"}},[a("a-input",{model:{value:t.product.name,callback:function(e){t.$set(t.product,"name",e)},expression:"product.name"}})],1)],1),this.productSlug?a("a-col",{staticStyle:{padding:"0 15px"},attrs:{md:24,lg:8}},[a("a-form-model-item",{ref:"url",attrs:{label:t.$t("product_url"),prop:"url"}},[a("a-input",{attrs:{disabled:""},model:{value:t.productSlug,callback:function(e){t.productSlug=e},expression:"productSlug"}})],1)],1):t._e(),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{md:24,lg:8}},[a("a-form-model-item",{attrs:{label:t.$t("position"),prop:"order"}},[a("a-input",{attrs:{type:"number"},model:{value:t.product.order,callback:function(e){t.$set(t.product,"order",e)},expression:"product.order"}})],1)],1),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{md:24,lg:8}},[a("a-form-model-item",{attrs:{label:t.$t("categories")}},[a("treeselect",{attrs:{id:"selectCategory",multiple:!1,"set-fields-value":t.product.category_id,options:t.getAllCategories,placeholder:t.$t("selectCategory")},model:{value:t.product.category_id,callback:function(e){t.$set(t.product,"category_id",e)},expression:"product.category_id"}})],1)],1),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{md:24,lg:8}},[a("a-form-model-item",{attrs:{label:t.$t("brand"),prop:"parent_id"}},[a("a-select",{attrs:{"show-search":"","auto-clear-search-value":!1,"filter-option":!1,placeholder:"brand"},on:{search:t.onBrandSearch},model:{value:t.product.brand_id,callback:function(e){t.$set(t.product,"brand_id",e)},expression:"product.brand_id"}},t._l(t.brandsSelect,(function(e){return a("a-select-option",{key:e.id,attrs:{title:e.name,value:e.id}},[t._v(" "+t._s(e.name)+" ")])})),1)],1)],1),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{md:24,lg:8}},[a("a-form-model-item",{attrs:{label:t.$t("additional_categories")}},[a("treeselect",{attrs:{id:"selectCategory",multiple:!0,"set-fields-value":t.product.additional_categories,options:t.getAllCategories,placeholder:t.$t("selectCategory")},model:{value:t.product.additional_categories,callback:function(e){t.$set(t.product,"additional_categories",e)},expression:"product.additional_categories"}})],1)],1),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{md:24,lg:8}},[a("a-form-model-item",{ref:"external_id",attrs:{label:t.$t("product_external_id"),prop:"external_id"}},[a("a-input",{model:{value:t.product.external_id,callback:function(e){t.$set(t.product,"external_id",e)},expression:"product.external_id"}})],1)],1),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{md:24,lg:8}},[a("a-form-model-item",{ref:"code",attrs:{label:t.$t("product_code"),prop:"code"}},[a("a-input",{model:{value:t.product.code,callback:function(e){t.$set(t.product,"code",e)},expression:"product.code"}})],1)],1),a("a-col",{staticStyle:{padding:"30px 0px 15px 15px"},attrs:{span:24}},[a("a-form-model-item",{ref:"preview",attrs:{label:t.$t("product_preview_text"),prop:"preview"}},[a("tinymce",{model:{value:t.product.preview_text,callback:function(e){t.$set(t.product,"preview_text",e)},expression:"product.preview_text"}})],1)],1),a("a-col",{staticStyle:{padding:"30px 0px 15px 15px"},attrs:{span:24}},[a("a-form-model-item",{ref:"description",attrs:{label:t.$t("description"),prop:"description"}},[a("tinymce",{model:{value:t.product.description,callback:function(e){t.$set(t.product,"description",e)},expression:"product.description"}})],1)],1)],1)],1),a("a-tab-pane",{key:"2",attrs:{tab:t.$t("images")}},[a("a-row",[a("a-col",{style:{minHeight:"180px",padding:"0 15px"},attrs:{span:4}},[a("a-form-item",{attrs:{label:t.$t("uploadProductImage")}},[a("a-upload",{staticClass:"avatar-uploader",attrs:{"custom-request":t.uploadImage,"list-type":"picture-card","show-upload-list":!1,"before-upload":t.beforeUpload}},[t.imageUrl?a("img",{attrs:{src:t.imageUrl,alt:"avatar"}}):a("div",[a("a-icon",{attrs:{type:t.loading?"loading":"plus"}}),a("div",{staticClass:"ant-upload-text"},[t._v(" "+t._s(t.$t("uploadCategoryImage"))+" ")])],1)])],1)],1)],1),a("a-row",[a("a-form-item",{attrs:{label:t.$t("uploadProductGallery")}},[a("a-upload",{attrs:{"custom-request":t.uploadGalleryImage,"list-type":"picture-card","file-list":t.gallery,"before-upload":t.beforeUpload},on:{preview:t.handlePreview,change:t.handleChange}},[t.gallery.length<8?a("div",[a("a-icon",{attrs:{type:"plus"}}),a("div",{staticClass:"ant-upload-text"},[t._v(" Upload ")])],1):t._e()]),a("a-modal",{attrs:{visible:t.previewVisible,footer:null},on:{cancel:t.handleCancel}},[a("img",{attrs:{alt:"example",src:t.previewImage}})])],1)],1)],1),a("a-tab-pane",{key:"3",attrs:{tab:"SEO"}},[a("a-row",[a("a-col",{staticStyle:{padding:"0 15px"},attrs:{md:24,lg:8}},[a("a-form-model-item",{ref:"meta_title",attrs:{label:t.$t("product_meta_title"),prop:"meta_title"}},[a("a-input",{model:{value:t.product.meta.title,callback:function(e){t.$set(t.product.meta,"title",e)},expression:"product.meta.title"}})],1)],1),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{md:24,lg:8}},[a("a-form-model-item",{ref:"meta_desc",attrs:{label:t.$t("product_meta_description"),prop:"meta_desc"}},[a("a-input",{model:{value:t.product.meta.description,callback:function(e){t.$set(t.product.meta,"description",e)},expression:"product.meta.description"}})],1)],1),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{md:24,lg:8}},[a("a-form-model-item",{ref:"meta_tags",attrs:{label:t.$t("product_meta_tags"),prop:"meta_tags"}},[a("a-input",{model:{value:t.product.meta.tags,callback:function(e){t.$set(t.product.meta,"tags",e)},expression:"product.meta.tags"}})],1)],1)],1)],1),a("a-tab-pane",{key:"4",attrs:{tab:"Related Products"}},[a("a-button",{staticStyle:{margin:"0 0 15px"},attrs:{type:"primary"},on:{click:t.fetchTableData}},[t._v(" "+t._s(t.$t("add"))+" ")]),t.relatedProductsRow.length>0?a("a-button",{staticStyle:{margin:"0 15px"},attrs:{type:"danger"}},[t._v(" "+t._s(t.$t("delete"))+" "+t._s(t.relatedProductsRow.length)+" ")]):t._e(),a("a-modal",{attrs:{width:"80%",title:t.$t("add"),centered:""},on:{ok:t.handleAddRelatedProducts,cancel:function(){return t.modalVisible=!1}},model:{value:t.modalVisible,callback:function(e){t.modalVisible=e},expression:"modalVisible"}},[a("a-row",[a("a-col",{attrs:{span:8}}),a("a-col",{attrs:{span:8}}),a("a-col",{attrs:{span:8}},[a("a-input",{directives:[{name:"debounce",rawName:"v-debounce",value:t.searchProd,expression:"searchProd"}],attrs:{placeholder:t.$t("search")}})],1)],1),a("a-table",{attrs:{rowKey:function(t){return t.id},"row-selection":t.rowSelection,columns:t.columnsModal,"data-source":t.productsData,pagination:t.getPagination,loading:t.loadTable},on:{change:t.handleTableChange}})],1),a("a-table",{attrs:{rowKey:function(t){return t.id},"row-selection":t.relatedProductsRowSelection,columns:t.columns,"data-source":t.product.related_products},scopedSlots:t._u([{key:"action",fn:function(e,r){return[a("a-popconfirm",{attrs:{slot:"extra",placement:"topRight",title:t.$t("deleteMsg"),okText:t.$t("yes"),cancelText:t.$t("no")},on:{confirm:function(e){return t.removeProd(r)}},slot:"extra"},[a("a-tooltip",[a("template",{slot:"title"},[t._v(t._s(t.$t("delete")))]),a("a-button",{attrs:{id:"buttonDelete",type:"danger",icon:"delete"}})],2)],1)]}}])})],1),t.priceUpdatable?a("a-tab-pane",{key:"5",attrs:{tab:t.$t("price")}},[a("a-row",[a("a-col",{staticStyle:{padding:"0 15px"},attrs:{md:24,lg:12}},[a("a-form-model-item",{ref:"price",attrs:{label:t.$t("product_price"),prop:"price"}},[a("a-input",{model:{value:t.price.price,callback:function(e){t.$set(t.price,"price",e)},expression:"price.price"}})],1)],1),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{md:24,lg:12}},[a("a-form-model-item",{ref:"old_price",attrs:{label:t.$t("product_old_price"),prop:"old_price"}},[a("a-input",{model:{value:t.price.old_price,callback:function(e){t.$set(t.price,"old_price",e)},expression:"price.old_price"}})],1)],1),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{md:24,lg:12}},[a("a-form-model-item",{ref:"unired_price",attrs:{label:t.$t("unired_price"),prop:"unired_price"}},[a("a-input",{model:{value:t.unired.price,callback:function(e){t.$set(t.unired,"price",e)},expression:"unired.price"}})],1)],1),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{md:24,lg:12}},[a("a-form-model-item",{ref:"unired_old_price",attrs:{label:t.$t("unired_old_price"),prop:"unired_old_price"}},[a("a-input",{model:{value:t.unired.old_price,callback:function(e){t.$set(t.unired,"old_price",e)},expression:"unired.old_price"}})],1)],1)],1)],1):t._e(),t.priceUpdatable?a("a-tab-pane",{key:"6",attrs:{tab:t.$t("attributes")}},[a("a-row",[t._l(t.productProperties,(function(e){return a("a-col",{key:e.id,staticClass:"attributes",attrs:{md:24}},["text"===e.type||"number"===e.type?a("div",[a("label",{staticClass:"propertyLabel"},[t._v(t._s(e.name))]),a("a-input",{directives:[{name:"debounce",rawName:"v-debounce",value:function(){return t.debouncedRequest(t.value,e.id)},expression:"() => debouncedRequest(value, property.id)"}],attrs:{"default-value":t.setDefaultProperty(e.id)}})],1):t._e(),"select"===e.type?a("div",[a("label",{staticClass:"propertyLabel"},[t._v(t._s(e.name))]),a("a-select",{attrs:{placeholder:"Select an option","default-value":t.setDefaultProperty(e.id)},on:{change:function(a){return t.handleProperty(a,e.type,e.id)}}},t._l(e.options,(function(e){return a("a-select-option",{key:e.value,attrs:{title:e.name,value:e.value}},[t._v(" "+t._s(e.name)+" ")])})),1)],1):t._e(),"checkbox"===e.type?a("div",[a("label",{staticClass:"propertyLabel"},[t._v(t._s(e.name))]),a("a-checkbox-group",{attrs:{name:"checkboxgroup","default-value":t.setDefaultProperty(e.id)},on:{change:function(a){return t.handleProperty(a,e.type,e.id)}}},t._l(e.options,(function(e){return a("a-checkbox",{key:e.value,attrs:{value:e.value}},[t._v(" "+t._s(e.name)+" ")])})),1)],1):t._e(),"radio"===e.type?a("div",[a("label",{staticClass:"propertyLabel"},[t._v(t._s(e.name))]),a("a-radio-group",{attrs:{"button-style":"solid","default-value":t.setDefaultProperty(e.id)},on:{change:function(a){return t.handleProperty(a,e.type,e.id)}}},t._l(e.options,(function(e){return a("a-radio-button",{key:e.value,attrs:{value:e.value}},[t._v(" "+t._s(e.name)+" ")])})),1)],1):t._e()])})),a("div",[a("a-button",{attrs:{type:"primary"},on:{click:t.openAddAttrs}},[t._v(t._s(t.$t("add_attr")))]),a("a-modal",{attrs:{title:t.$t("add_attr")},on:{ok:t.addProductProperty},model:{value:t.addAttrProductModal,callback:function(e){t.addAttrProductModal=e},expression:"addAttrProductModal"}},[a("a-row",[a("a-col",{attrs:{span:24}},[a("label",{staticStyle:{"margin-bottom":"5px"},attrs:{for:"attrSelect"}},[t._v(t._s(t.$t("attributes")))]),a("a-select",{staticStyle:{width:"100%"},attrs:{id:"attrSelect"},model:{value:t.attrs_id,callback:function(e){t.attrs_id=e},expression:"attrs_id"}},t._l(t.allProductProperties,(function(e){return a("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ")])})),1)],1)],1)],1)],1)],2)],1):t._e(),t.productSlug?a("a-tab-pane",{key:"7",attrs:{tab:t.$t("reviews")}},[t.selectedReview?a("a-modal",{attrs:{title:t.$t("review_edit")},on:{ok:t.handleReviewEdit,cancel:t.closeReviewsModal},model:{value:t.reviewsModalStatus,callback:function(e){t.reviewsModalStatus=e},expression:"reviewsModalStatus"}},[a("a-row",[a("p",[t._v(t._s(this.selectedReview.customer_name))]),a("a-switch",{staticStyle:{margin:"0 0 15px"},attrs:{"checked-children":t.$t("active"),"un-checked-children":t.$t("inactive")},model:{value:t.selectedReview.active,callback:function(e){t.$set(t.selectedReview,"active",e)},expression:"selectedReview.active"}}),a("a-col",{attrs:{span:24}},[a("label",{staticStyle:{"margin-bottom":"5px"},attrs:{for:"reviewEdit"}},[t._v(t._s(t.$t("comment")))]),a("a-textarea",{attrs:{id:"reviewEdit","auto-size":{minRows:2,maxRows:6}},model:{value:t.selectedReview.comment,callback:function(e){t.$set(t.selectedReview,"comment",e)},expression:"selectedReview.comment"}})],1)],1)],1):t._e(),a("a-table",{attrs:{rowKey:function(t){return t.id},"row-selection":t.rowSelection,columns:t.reviewColumns,"data-source":t.reviewsData,pagination:t.getReviewsPagination,loading:t.loadTable},on:{change:t.handleReviewTableChange},scopedSlots:t._u([{key:"status",fn:function(e){return[e.active?a("a-tag",{attrs:{color:"#108ee9"}},[t._v(" "+t._s(t.$t("active"))+" ")]):a("a-tag",{attrs:{color:"#f50"}},[t._v(" "+t._s(t.$t("inactive"))+" ")])]}},{key:"action",fn:function(e){return[a("a-tooltip",[a("template",{slot:"title"},[t._v(t._s(t.$t("update")))]),a("a-button",{attrs:{type:"primary",icon:"edit"},on:{click:function(a){return t.openReviewsModal(e)}}})],2),a("a-popconfirm",{attrs:{slot:"extra",placement:"topRight",title:t.$t("deleteMsg"),okText:t.$t("yes"),cancelText:t.$t("no")},on:{confirm:function(a){return t.removeReview(e.id)}},slot:"extra"},[a("a-tooltip",[a("template",{slot:"title"},[t._v(t._s(t.$t("delete")))]),a("a-button",{attrs:{type:"danger",icon:"delete"}})],2)],1)]}}],null,!1,4292505862)})],1):t._e()],1)],1)],1)}),n=[];a("a4d3"),a("e01a"),a("99af"),a("4de4"),a("7db0"),a("caad"),a("a15b"),a("d81d"),a("13d5"),a("a434"),a("b0c0"),a("d3b7"),a("ac1f"),a("2532"),a("5319"),a("1276"),a("96cf"),a("e6cf");function c(t,e,a,r,o,i,n){try{var c=t[i](n),l=c.value}catch(d){return void a(d)}c.done?e(l):Promise.resolve(l).then(r,o)}function l(t){return function(){var e=this,a=arguments;return new Promise((function(r,o){var i=t.apply(e,a);function n(t){c(i,r,o,n,l,"next",t)}function l(t){c(i,r,o,n,l,"throw",t)}n(void 0)}))}}var d=a("6b75");function s(t){if(Array.isArray(t))return Object(d["a"])(t)}a("d28b"),a("a630"),a("e260"),a("3ca3"),a("ddb0");function u(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}var p=a("06c5");function m(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f(t){return s(t)||u(t)||Object(p["a"])(t)||m()}var g=a("5530"),h=a("b017"),b=a("b775"),v=a("ca17"),y=a.n(v),_=(a("542c"),a("5880"));function w(t){if(t)return t.map((function(t){return null===t.children?Object(g["a"])(Object(g["a"])({},t),{},{label:t.name}):Object(g["a"])(Object(g["a"])({},t),{},{label:t.name,children:w(t.children)})}))}function $(t,e){var a=new FileReader;a.addEventListener("load",(function(){return e(a.result)})),a.readAsDataURL(t)}function x(t){return new Promise((function(e,a){var r=new FileReader;r.readAsDataURL(t),r.onload=function(){return e(r.result)},r.onerror=function(t){return a(t)}}))}var P={components:{tinymce:h["a"],Treeselect:y.a},data:function(){return{productId:null,activeTabKey:"1",priceUpdatable:!1,createdProductSlug:null,brandsSelect:[],productSlug:this.$route.params.id,labelCol:{span:24},wrapperCol:{span:24},other:"",loading:!1,loadTable:!1,imageUrl:"",attrs_id:"",gallery:[],unired:{old_price:0,price:0,price_type_id:"1"},price:{old_price:0,price:0,price_type_id:""},product:{name:"",active:!0,brand_id:"",category_id:null,order:0,description:"",image:"",gallery:[],preview_text:"",related_products:[],additional_categories:[],meta:{title:"",tags:"",description:""},external_id:null,code:""},previewVisible:!1,previewImage:"",modalVisible:!1,addAttrProductModal:!1,relatedProductsRow:[],updatePriceOnly:!1,allProductProperties:null,productProperties:[],productDefaultProperties:null,tabCategories:[],reviewsModalStatus:!1,selectedReview:null,customerComment:null,rules:{name:[{required:!0,message:this.$t("required"),trigger:"change"}],order:[{required:!0,message:this.$t("required"),trigger:"change"}],external_id:[{required:!0,message:this.$t("required"),trigger:"change"}],desc:[{required:!0,message:this.$t("required"),trigger:"blur"}]},selectedRowKeys:[],columns:[{title:this.$t("product_name"),dataIndex:"name"},{title:this.$t("brand"),dataIndex:"brand.name"},{title:this.$t("category"),dataIndex:"category.name"},{title:this.$t("price"),dataIndex:"price.price"},{title:this.$t("action"),key:"action",width:"20%",scopedSlots:{customRender:"action"}}],columnsModal:[{title:this.$t("product_name"),dataIndex:"name"},{title:this.$t("brand"),dataIndex:"brand.name"},{title:this.$t("category"),dataIndex:"category.name"},{title:this.$t("price"),dataIndex:"price.price"}],reviewColumns:[{title:this.$t("customer_name"),dataIndex:"customer_name"},{title:this.$t("rating"),dataIndex:"rate",width:"10%"},{title:this.$t("comment"),dataIndex:"comment"},{title:this.$t("status"),key:"status",width:"20%",scopedSlots:{customRender:"status"}},{title:this.$t("action"),key:"action",width:"20%",scopedSlots:{customRender:"action"}}]}},props:{lang:String},computed:Object(g["a"])(Object(g["a"])({},Object(_["mapGetters"])(["productsData","productsPagination","reviewsData","reviewsPagination","categories","brands","allAttrs"])),{},{getAllCategories:function(){return w(this.tabCategories)},getAllBrands:function(){return this.brandsSelect},getPagination:function(){return this.productsPagination},getReviewsPagination:function(){return this.reviewsPagination},relatedProductsRowSelection:function(){var t=this.relatedProductsRow;return{selectedRowKeys:t,onChange:this.onRelatedProductsSelectChange,hideDefaultSelections:!0,selections:[],onSelection:this.onSelection}},rowSelection:function(){var t=this.selectedRowKeys;return{selectedRowKeys:t,onChange:this.onSelectChange,hideDefaultSelections:!0,selections:[{key:"all-data",text:"Select All Data",onSelect:function(){}}],onSelection:this.onSelection}}}),mounted:function(){var t=this;this.getCategories({page:null,lang:this.lang,search:!1}).then((function(){t.tabCategories=t.categories})).catch((function(t){})),this.getBrands({page:null,search:!1}).then((function(){t.brandsSelect=t.brands})),this.getProducts({page:this.productsPagination,search:!1}),this.getReviews({page:null,productSlug:this.productSlug}),this.productSlug&&(this.getProductData(),this.priceUpdatable=!0)},methods:Object(g["a"])(Object(g["a"])({},Object(_["mapActions"])(["getCategories","getBrands","getProducts","getReviews","setSearchQuery","getAllAttrs"])),{},{removeProd:function(t){for(var e=0;e<this.product.related_products.length;e++)this.product.related_products[e]===t&&this.product.related_products.splice(e,1)},searchProd:function(t){var e=this;this.loadTable=!0,this.setSearchQuery(t),this.getProducts({page:this.productsPagination,search:t}).then((function(t){e.loadTable=!1}))},getProductData:function(){var t=this;Object(b["b"])({url:"/product/".concat(this.productSlug),method:"get",params:{lang:this.lang,onlyRelatedProducts:!0}}).then((function(e){var a=e.product;t.productId=a.id,t.product.name=a.name,t.product.description=a.description,t.product.preview_text=a.preview_text,t.product.order=a.order,t.product.category_id=a.category.id,t.product.brand_id=a.brand.id,t.product.external_id=a.external_id,t.product.code=a.code,t.product.order=a.order||1,t.imageUrl=a.image,t.product.image=a.image.split("/")[4],t.price.price=a.price.price||0,t.price.old_price=a.price.old_price||0,t.unired.price=a.prices[0].price||0,t.unired.old_price=a.prices[0].old_price||0,t.product.active=a.active;var r=!1;return t.brands.map((function(t){t.id===a.brand.id&&(r=!0)})),r||t.brands.push({name:a.brand.name,id:a.brand.id}),t.product.meta.title=a.meta.title,t.product.meta.description=a.meta.description,t.product.meta.tags=a.meta.tags,t.product.related_products=a.related_products,t.product.additional_categories=a.additional_categories?a.additional_categories.map((function(t){return t.id})):[],t.product.gallery=a.gallery?a.gallery.map((function(t,e){var a=t.split("/")[4];return{filename:a,uid:e}})):[],t.gallery=a.gallery?a.gallery.map((function(t,e){return{type:"image/jpg",status:"done",uid:e,url:t}})):[],t.productDefaultProperties=a.properties&&a.properties.map((function(t){return"checkbox"===t.property.type&&t.length>1?Object(g["a"])(Object(g["a"])({},t),{},{value:t.value.split(",")}):Object(g["a"])(Object(g["a"])({},t),{},{value:t.value})})),e})).then((function(e){var a=e.product,r=a.category.slug,o=a.properties;t.getProductAttributes(r,o)})).catch((function(t){}))},getProductAttributes:function(t,e){var a=this;Object(b["b"])({url:"/category/".concat(t,"?lang=").concat(this.lang),method:"get"}).then((function(t){var e=t.category.product_properties||[];a.productDefaultProperties&&a.productDefaultProperties.map((function(t){return t.property})).forEach((function(t){var a=e.filter((function(e,a){return e.id===t.id}));a.length||e.push(t)})),a.productProperties=e}))},addProductProperty:function(){var t=this,e=this.allProductProperties.find((function(e){return e.id===t.attrs_id}));this.productProperties=[].concat(f(this.productProperties),[e]),this.addAttrProductModal=!1},openAddAttrs:function(){var t=this;this.getAllAttrs({page:1}).then((function(e){t.addAttrProductModal=!0,t.allProductProperties=e.product_properties}))},onBrandSearch:function(t){var e=this;Object(b["b"])({url:"/brand",method:"get",params:{search:t}}).then((function(t){e.brandsSelect=[],t.brands.map((function(t){e.brandsSelect.push({name:t.name,id:t.id})}))}))},uploadGalleryImage:function(t){var e=this,a=new FormData;a.append("file",t.file),Object(b["b"])({url:"/upload",method:"post",data:a}).then((function(a){e.product.gallery.push({filename:a.filename,uid:t.file.uid})})).catch((function(t){}))},uploadImage:function(t){var e=this;this.loading=!0;var a=new FormData;a.append("file",t.file),Object(b["b"])({url:"/upload",method:"post",data:a}).then((function(a){$(t.file,(function(t){e.imageUrl=t})),e.loading=!1,e.product.image=a.filename})).catch((function(t){e.loading=!1}))},beforeUpload:function(t){var e="image/jpeg"===t.type||"image/png"===t.type;return e||this.$message.error("You can only upload JPG, PNG file!"),e},fetchTableData:function(){this.modalVisible=!0,this.getProducts({page:this.productsPagination,search:!1}).then((function(t){}))},handleTableChange:function(t){var e=this;this.getProducts({page:t,search:!0}).then((function(t){})).catch((function(t){return e.requestFailed(t)}))},handleReviewTableChange:function(t){var e=this;this.loadTable=!0,this.getReviews({page:t,productSlug:this.productSlug}).then((function(t){})).catch((function(t){return e.requestFailed(t)})).finally((function(){return e.loadTable=!1}))},openReviewsModal:function(t){this.reviewsModalStatus=!0,this.selectedReview=t},closeReviewsModal:function(){this.reviewsModalStatus=!1},handleReviewEdit:function(){var t=this,e=this.selectedReview,a=e.id,r=e.active,o=e.comment,i=e.customer_id,n=e.customer_name,c=e.rate;Object(b["b"])({url:"/feedback/".concat(a),method:"put",data:{active:r,comment:o,customer_id:i,customer_name:n,rate:c}}).then((function(e){t.$message.success(t.$t("successfullyUpdated"))})).catch((function(e){t.$message.error(t.$t("error"))})).finally((function(){return t.reviewsModalStatus=!1}))},removeReview:function(t){var e=this;this.loadTable=!0,Object(b["b"])({url:"/feedback/".concat(t),method:"delete"}).then((function(t){e.getReviews({page:e.reviewsPagination,productSlug:e.productSlug}),e.$message.success(e.$t("successfullyDeleted"))})).catch((function(t){e.$message.error(e.$t("error"))})).finally((function(){return e.loadTable=!1}))},onSelectChange:function(t){this.selectedRowKeys=t},onRelatedProductsSelectChange:function(t){this.relatedProductsRow=t},handleAddRelatedProducts:function(){var t=this;this.product.related_products=this.productsData.filter((function(e){return t.selectedRowKeys.includes(e.id)})),this.modalVisible=!1},getRelatedProductIds:function(t){return t?t.map((function(t){return t.id})).join(","):""},convertArrayToString:function(t){return t?t.join(","):""},onSubmit:function(){var t=this,e={"Content-Type":"application/json"};this.$refs.ruleForm.validate((function(a){if(!a)return!1;var r="/product",o="post";if(t.productSlug){r="/product/".concat(t.productSlug),o="put",t.$emit("clickParent",!0),Object(b["b"])({url:r,method:o,data:Object(g["a"])(Object(g["a"])({},t.product),{},{additional_categories:t.convertArrayToString(t.product.additional_categories),gallery:t.product.gallery.map((function(t){return t.filename})).join(","),related_products:t.getRelatedProductIds(t.product.related_products),lang:t.lang||""}),headers:e}).then((function(t){})).catch((function(e){t.$message.error(t.$t("error"))}));var i=t.productSlug;return Object(b["b"])({url:"/product/".concat(i,"/update-price"),method:"put",data:t.price,headers:e}).then((function(t){})).catch((function(t){})),void Object(b["b"])({url:"/product/".concat(i,"/update-price"),method:"put",data:t.unired,headers:e}).then((function(e){"/catalog/products"!==t.$route.path&&t.$router.replace("/catalog/products")})).catch((function(t){})).finally((function(){t.$emit("clickParent",!1)}))}if(t.priceUpdatable){var n=t.createdProductSlug||t.productSlug;if(t.updatePriceOnly)return t.$emit("clickParent",!0),Object(b["b"])({url:"/product/".concat(n,"/update-price"),method:"put",data:t.price,headers:e}).then((function(t){})).catch((function(t){})),void Object(b["b"])({url:"/product/".concat(n,"/update-price"),method:"put",data:t.unired,headers:e}).then((function(e){"/catalog/products"!==t.$route.path&&t.$router.replace("/catalog/products")})).catch((function(t){})).finally((function(){t.$emit("clickParent",!1)}))}t.$emit("clickParent",!0),Object(b["b"])({url:r,method:o,data:Object(g["a"])(Object(g["a"])({},t.product),{},{additional_categories:t.convertArrayToString(t.product.additional_categories),gallery:t.product.gallery.map((function(t){return t.filename})).join(","),related_products:t.getRelatedProductIds(t.product.related_products),lang:t.lang||""}),headers:e}).then((function(e){t.createdProductSlug=e.product.slug,t.priceUpdatable=!0,t.activeTabKey="5",t.updatePriceOnly=!0})).catch((function(e){t.$message.success(t.$t("error"))})).finally((function(){t.$emit("clickParent",!1)}))}))},resetForm:function(){this.$refs.ruleForm.resetFields()},handleCancel:function(){this.previewVisible=!1},handlePreview:function(t){var e=this;return l(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.url||t.preview){a.next=4;break}return a.next=3,x(t.originFileObj);case 3:t.preview=a.sent;case 4:e.previewImage=t.url||t.preview,e.previewVisible=!0;case 6:case"end":return a.stop()}}),a)})))()},handleChange:function(t){var e=t.fileList;this.gallery=e.map((function(t){return Object(g["a"])(Object(g["a"])({},t),{},{status:"done"})})),"removed"===t.file.status&&(this.product.gallery=this.product.gallery.reduce((function(t,a){var r=e.map((function(t){return t.uid}));return r.includes(a.uid)&&t.push(a),t}),[]))},activeTabHandler:function(t){this.activeTabKey=t},debouncedRequest:function(t,e){var a=this;this.loading=!0;var r={"Content-Type":"application/json"};Object(b["b"])({url:"/product/".concat(this.productId,"/update-property"),method:"put",data:{property_id:e,value:t},headers:r}).then((function(t){})).catch((function(t){})).finally((function(){return a.loading=!1}))},handleProperty:function(t,e,a){var r,o=this;this.loading=!0,r="radio"===e?t.target.value:t;var i={"Content-Type":"application/json"};Object(b["b"])({url:"/product/".concat(this.productId,"/update-property"),method:"put",data:{property_id:a,value:"checkbox"===e?r.join(","):r},headers:i}).then((function(t){})).catch((function(t){})).finally((function(){return o.loading=!1}))},setDefaultProperty:function(t){var e=[];if(this.productDefaultProperties&&this.productDefaultProperties.length)for(var a=0;a<this.productDefaultProperties.length;a++)this.productDefaultProperties[a]&&this.productDefaultProperties[a].property.id===t&&(e=this.productDefaultProperties[a].value);return e}})},S=P,k=(a("ee53"),a("2877")),R=Object(k["a"])(S,i,n,!1,null,"58d5a21e",null),j=R.exports,O=function(t){var e={ru:"Русский",uz:"O'zbekcha",en:"English"};return e[t]},C=function(t){var e={uz:"uz",ru:"ru",en:"gb"};return e[t]},T={data:function(){return{btnLoading:!1,activeTabKey:1,edit:!!this.$route.params.id,langs:["ru","uz"]}},methods:{langMapper:O,flagMapper:C,clickParent:function(t){this.btnLoading=t},submit:function(){this.edit?Object.values(this.$refs).forEach((function(t){t&&t[0].onSubmit()})):this.$refs.createForm.onSubmit()},resetForm:function(){this.edit?Object.entries(this.$refs).forEach((function(t){t&&t.resetForm()})):this.$refs.createForm.resetForm()}},components:{"v-main":j}},D=T,A=Object(k["a"])(D,r,o,!1,null,null,null);e["default"]=A.exports},ee53:function(t,e,a){"use strict";var r=a("79ff"),o=a.n(r);o.a}}]);