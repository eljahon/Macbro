(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-52cc3abc"],{"22dc":function(t,e,a){"use strict";var r=a("c4b5"),i=a.n(r);i.a},"2c4a":function(t,e,a){"use strict";var r=a("ae14"),i=a.n(r);i.a},ae14:function(t,e,a){},c4b5:function(t,e,a){},e0cb:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-row",[a("a-col",{attrs:{span:12}},[a("a-breadcrumb",{staticStyle:{margin:"10px 5px"}},[a("a-breadcrumb-item",[a("router-link",{attrs:{to:"/catalog/categories/list"}},[t._v(t._s(t.$t("categories")))])],1),a("a-breadcrumb-item",[t._v(t._s(t.$t("add")))])],1)],1)],1),t.edit?a("div",[a("a-card",{attrs:{title:t.$t("fillIn")}},[a("a-row",[a("a-tabs",{attrs:{type:"card"},model:{value:t.activeTabKey,callback:function(e){t.activeTabKey=e},expression:"activeTabKey"}},[a("a-tab-pane",{key:"1"},[a("span",{attrs:{slot:"tab"},slot:"tab"},[a("flag",{attrs:{iso:"ru"}}),t._v(" Русский ")],1),a("v-main",{ref:"ruEditForm",attrs:{lang:"ru"}})],1),a("a-tab-pane",{key:"2"},[a("span",{attrs:{slot:"tab"},slot:"tab"},[a("flag",{attrs:{iso:"uz"}}),t._v(" O'zbekcha ")],1),a("v-main",{ref:"uzEditForm",attrs:{lang:"uz"}})],1)],1)],1)],1)],1):a("div",[a("a-card",{attrs:{title:t.$t("fillIn")}},[a("v-main",{ref:"createForm"})],1)],1),a("a-row",[a("a-col",{staticStyle:{padding:"15px 0"},attrs:{span:24}},[a("a-form-model-item",[a("a-button",{attrs:{type:"primary","html-type":"submit"},on:{click:function(e){return e.preventDefault(),t.submit(e)}}},[t._v(" "+t._s(t.$t("save"))+" ")]),a("a-button",{staticStyle:{"margin-left":"10px"},on:{click:function(e){return e.preventDefault(),t.resetForm(e)}}},[t._v(" "+t._s(t.$t("reset"))+" ")])],1)],1)],1)],1)},i=[],o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-switch",{staticStyle:{margin:"15px 0"},attrs:{slot:"extra","checked-children":t.$t("active"),"un-checked-children":t.$t("inactive"),"default-checked":""},slot:"extra",model:{value:t.category.active,callback:function(e){t.$set(t.category,"active",e)},expression:"category.active"}}),a("a-form-model",{ref:"ruleForm",attrs:{model:t.category,rules:t.rules,"label-col":t.labelCol,"wrapper-col":t.wrapperCol},on:{submit:t.onSubmit}},[a("a-row",[a("a-tabs",{attrs:{type:"card"},model:{value:t.activeTabKey,callback:function(e){t.activeTabKey=e},expression:"activeTabKey"}},[a("a-tab-pane",{key:"1",attrs:{tab:t.$t("basicSettings")}},[a("a-col",{staticStyle:{padding:"0 15px"},attrs:{span:12}},[a("a-form-model-item",{ref:"name",attrs:{label:t.$t("category_name"),prop:"name"}},[a("a-input",{model:{value:t.category.name,callback:function(e){t.$set(t.category,"name",e)},expression:"category.name"}})],1)],1),this.categorySlug?a("a-col",{staticStyle:{padding:"0 15px"},attrs:{span:12}},[a("a-form-model-item",{ref:"url",attrs:{label:t.$t("category_url"),prop:"url"}},[a("a-input",{attrs:{disabled:""},model:{value:t.categorySlug,callback:function(e){t.categorySlug=e},expression:"categorySlug"}})],1)],1):t._e(),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{span:12}},[a("a-form-model-item",{attrs:{label:t.$t("position"),prop:"order"}},[a("a-input",{attrs:{type:"number"},model:{value:t.category.order,callback:function(e){t.$set(t.category,"order",e)},expression:"category.order"}})],1)],1),a("a-col",{style:{minHeight:"180px",padding:"0 15px"},attrs:{md:24,lg:8}},[a("a-form-item",{attrs:{label:t.$t("parentCategory")}},[a("treeselect",{attrs:{id:"selectCategory",multiple:!1,"set-fields-value":t.category.parent_id,options:t.getAllCategories,placeholder:t.$t("selectCategory")},model:{value:t.category.parent_id,callback:function(e){t.$set(t.category,"parent_id",e)},expression:"category.parent_id"}})],1)],1),a("a-col",{style:{minHeight:"180px",padding:"0 15px"},attrs:{span:24}},[a("a-form-item",{attrs:{label:t.$t("image")}},[a("a-upload",{staticClass:"avatar-uploader",attrs:{"custom-request":t.uploadImage,"list-type":"picture-card","show-upload-list":!1,"before-upload":t.beforeUpload}},[t.imageUrl?a("img",{attrs:{src:t.imageUrl,alt:"avatar"}}):a("div",[a("a-icon",{attrs:{type:t.loading?"loading":"plus"}}),a("div",{staticClass:"ant-upload-text"},[t._v(" "+t._s(t.$t("uploadCategoryImage"))+" ")])],1)])],1)],1),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{span:24}},[a("a-form-model-item",{ref:"description",attrs:{label:t.$t("description"),prop:"description"}},[a("tinymce",{model:{value:t.category.description,callback:function(e){t.$set(t.category,"description",e)},expression:"category.description"}})],1)],1)],1),a("a-tab-pane",{key:"2",attrs:{tab:"SEO"}},[a("a-row",[a("a-col",{staticStyle:{padding:"0 15px"},attrs:{span:8}},[a("a-form-model-item",{attrs:{label:t.$t("meta_title")}},[a("a-input",{attrs:{type:"text",placeholder:t.$t("meta_title")},model:{value:t.category.meta.title,callback:function(e){t.$set(t.category.meta,"title",e)},expression:"category.meta.title"}})],1)],1),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{span:8}},[a("a-form-model-item",{attrs:{label:t.$t("meta_description")}},[a("a-input",{attrs:{type:"text",placeholder:t.$t("meta_description")},model:{value:t.category.meta.description,callback:function(e){t.$set(t.category.meta,"description",e)},expression:"category.meta.description"}})],1)],1),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{span:8}},[a("a-form-model-item",{attrs:{label:t.$t("meta_tags")}},[a("a-input",{attrs:{type:"text",placeholder:t.$t("meta_tags")},model:{value:t.category.meta.tags,callback:function(e){t.$set(t.category.meta,"tags",e)},expression:"category.meta.tags"}})],1)],1)],1)],1),a("a-tab-pane",{key:"3",attrs:{tab:t.$t("attributes")}},[a("a-card",{attrs:{title:t.$t("attributes")}},[a("a-tooltip",{attrs:{placement:"right"}},[a("template",{slot:"title"},[a("span",[t._v("Привязка атрибутов к категории и фильтру")])]),a("a-button",{style:{margin:"0 0 1rem 0"},attrs:{type:"primary"},on:{click:t.addAttr}},[t._v(t._s(t.$t("add_attr")))])],2),a("a-row",[a("a-table",{attrs:{columns:t.columns,dataSource:t.tableAttrData,rowKey:function(t){return t.id}},scopedSlots:t._u([{key:"status",fn:function(e){return[e?a("a-tag",{attrs:{color:"#108ee9"}},[t._v(t._s(t.$t("active")))]):a("a-tag",{attrs:{color:"#f50"}},[t._v(t._s(t.$t("inactive")))])]}},{key:"action",fn:function(e){return[a("a-tooltip",[a("template",{slot:"title"},[t._v(t._s(t.$t("delete")))]),a("a-button",{attrs:{id:"buttonDelete",type:"danger",icon:"delete"},on:{click:function(a){return t.removeAttr(e)}}})],2)]}}])})],1)],1)],1)],1)],1),a("a-modal",{attrs:{title:t.$t("add_attr")+" (Привязка атрибутов к категории и фильтру):",width:"600px"},model:{value:t.isOpenAttrAdd,callback:function(e){t.isOpenAttrAdd=e},expression:"isOpenAttrAdd"}},[a("a-row",[a("a-col",{attrs:{span:24}},[a("a-select",{staticStyle:{width:"100%"},attrs:{mode:"multiple",size:"large",placeholder:t.$t("add_attr"),"filter-option":t.filterOption},model:{value:t.attributes,callback:function(e){t.attributes=e},expression:"attributes"}},t._l(t.allAttrs,(function(e,r){return a("a-select-option",{key:r+e.id,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ")])})),1)],1)],1),a("template",{slot:"footer"},[a("a-button",{key:"back",on:{click:t.closeModal}},[t._v(" "+t._s(t.$t("cancel"))+" ")]),a("a-button",{key:"submit",attrs:{type:"primary"},on:{click:t.addAttributes}},[t._v(" "+t._s(t.$t("add"))+" ")])],1)],2)],1)],1)},s=[],n=(a("a4d3"),a("e01a"),a("99af"),a("c975"),a("d81d"),a("a434"),a("b0c0"),a("d3b7"),a("ac1f"),a("25f0"),a("5319"),a("1276"),a("5530")),l=a("ca17"),c=a.n(l),u=(a("542c"),a("b017")),d=a("b775"),p=a("5880");function m(t){if(t)return t.map((function(t){return null===t.children?Object(n["a"])(Object(n["a"])({},t),{},{label:t.name}):Object(n["a"])(Object(n["a"])({},t),{},{label:t.name,children:m(t.children)})}))}function g(t,e){var a=new FileReader;a.addEventListener("load",(function(){return e(a.result)})),a.readAsDataURL(t)}var b={props:{lang:String},components:{tinymce:u["a"],Treeselect:c.a},data:function(){return{categorySlug:this.$route.params.id,activeTabKey:"1",labelCol:{span:24},wrapperCol:{span:24},other:"",loading:!1,imageUrl:"",category:{name:"",parent_id:null,order:0,meta:{description:"",tags:"",title:""},description:"",image:"",active:!0,product_property_groups:""},rules:{name:[{required:!0,message:this.$t("required"),trigger:"change"}],order:[{required:!0,message:this.$t("required"),trigger:"change"}],resource:[{required:!0,message:"Please select activity resource",trigger:"change"}],desc:[{required:!0,message:"Please input activity form",trigger:"blur"}]},isOpenAttrAdd:!1,attributes:[],tableAttrData:[],columns:[{title:this.$t("attr_name"),dataIndex:"name"},{title:this.$t("attribute_type"),dataIndex:"type"},{title:this.$t("status"),dataIndex:"active",scopedSlots:{customRender:"status"}},{title:this.$t("action"),key:"action",width:"20%",scopedSlots:{customRender:"action"}}]}},mounted:function(){this.getAllAttrs(),this.categorySlug&&this.getCategoryAttrs(this.categorySlug),"ru"===this.lang?this.getCategories({page:null,lang:"ru",search:!1}):"uz"===this.lang&&this.getCategories({page:null,lang:"uz",search:!1})},computed:Object(n["a"])(Object(n["a"])({},Object(p["mapGetters"])(["categories","allAttrs"])),{},{getAllCategories:function(){return m(this.categories)}}),methods:Object(n["a"])(Object(n["a"])({},Object(p["mapActions"])(["getCategories","getAllAttrs"])),{},{getCategoryAttrs:function(){var t=this;Object(d["b"])({url:"/category/".concat(this.categorySlug,"?lang=").concat(this.lang),method:"get"}).then((function(e){t.category.name=e.category.name,t.category.description=e.category.description,t.category.order=e.category.order,t.category.parent_id=e.category.parent.id||null,t.category.image=e.category.image.split("/")[4],t.imageUrl=e.category.image,t.category.meta=e.category.meta,t.tableAttrData=e.category.product_properties,e.category.product_properties&&(t.attributes=e.category.product_properties.map((function(t){return t.id})))}))},uploadImage:function(t){var e=this;this.loading=!0;var a=new FormData;a.append("file",t.file),Object(d["b"])({url:"/upload",method:"post",data:a}).then((function(a){g(t.file,(function(t){e.imageUrl=t,e.loading=!1})),e.category.image=a.filename}))},beforeUpload:function(t){var e="image/jpeg"===t.type||"image/png"===t.type;return e||this.$message.error("You can only upload JPG, PNG file!"),e},onReady:function(t){t.ui.getEditableElement().parentElement.insertBefore(t.ui.view.toolbar.element,t.ui.getEditableElement())},onSubmit:function(){var t=this;this.$refs.ruleForm.validate((function(e){if(!e)return!1;var a="/category",r="post";t.categorySlug&&(a="/category/".concat(t.categorySlug),r="put");var i={"Content-Type":"application/json"};Object(d["b"])({url:a,method:r,data:Object(n["a"])(Object(n["a"])({},t.category),{},{product_properties:t.attributes.toString(),lang:t.lang||"ru"}),headers:i}).then((function(e){t.$router.replace("/catalog/categories")})).then((function(e){e&&t.$message.success(t.$t("error"))}))}))},resetForm:function(){this.$refs.ruleForm.resetFields()},removeAttr:function(t){for(var e=0;e<this.tableAttrData.length;e++)t.id===this.tableAttrData[e].id&&this.tableAttrData.splice(e,1);for(var a=0;a<this.attributes.length;a++)t.id===this.attributes[a]&&this.attributes.splice(a,1)},addAttributes:function(){var t=this.allAttrs,e=this.attributes;if(this.tableAttrData=[],e.length>0){for(var a=0;a<e.length;a++)for(var r=0;r<t.length;r++)e[a]===t[r].id&&this.tableAttrData.push(t[r]);this.isOpenAttrAdd=!1}},filterOption:function(t,e){return e.componentOptions.children[0].text.toLowerCase().indexOf(t.toLowerCase())>=0},addAttr:function(){this.isOpenAttrAdd=!0},closeModal:function(){this.isOpenAttrAdd=!1}})},f=b,y=(a("2c4a"),a("2877")),h=Object(y["a"])(f,o,s,!1,null,null,null),v=h.exports,$={data:function(){return{activeTabKey:"1",edit:!!this.$route.params.id}},mounted:function(){},methods:{submit:function(){if(this.edit){if(!this.$refs.uzEditForm)return void this.$refs.ruEditForm.onSubmit();this.$refs.ruEditForm.onSubmit(),this.$refs.uzEditForm.onSubmit()}else this.$refs.createForm.onSubmit()},resetForm:function(){if(this.edit){if(!this.$refs.uzEditForm)return void this.$refs.ruEditForm.resetForm();this.$refs.ruEditForm.resetForm(),this.$refs.uzEditForm.resetForm()}else this.$refs.createForm.resetForm()}},components:{"v-main":v}},_=$,x=(a("22dc"),Object(y["a"])(_,r,i,!1,null,null,null));e["default"]=x.exports}}]);