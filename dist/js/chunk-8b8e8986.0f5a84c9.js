(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8b8e8986"],{"0faf":function(t,e,a){"use strict";var r=a("d82f"),n=a.n(r);n.a},"5e75":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-row",[a("a-col",{attrs:{span:12}},[a("a-breadcrumb",{staticStyle:{margin:"10px 5px"}},[a("a-breadcrumb-item",[a("router-link",{attrs:{to:"/orders/list"}},[t._v(t._s(t.$t("orders")))])],1),a("a-breadcrumb-item",[t._v(t._s(t.$t("add")))])],1)],1)],1),a("a-card",{attrs:{title:t.$t("fillIn")}},[a("a-row",[a("v-main",{ref:"orderDetailsEdit"})],1)],1),a("a-row",[a("a-col",{staticStyle:{padding:"15px 0"},attrs:{span:24}},[a("a-form-model-item",[a("a-button",{attrs:{type:"primary","html-type":"submit"},on:{click:function(e){return e.preventDefault(),t.submit(e)}}},[t._v(" "+t._s(t.$t("save"))+" ")]),a("a-button",{staticStyle:{"margin-left":"10px"},on:{click:function(e){return e.preventDefault(),t.resetForm(e)}}},[t._v(" "+t._s(t.$t("reset"))+" ")])],1)],1)],1)],1)},n=[],o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-form-model",{ref:"ruleForm",attrs:{model:t.order,rules:t.rules,"label-col":t.labelCol,"wrapper-col":t.wrapperCol},on:{submit:t.onSubmit}},[a("a-row",[a("a-col",{staticStyle:{padding:"0 15px"},attrs:{span:12}},[a("a-form-model-item",{ref:"orderNumber",attrs:{label:t.$t("order_number"),prop:"orderNumber"}},[a("a-input",{attrs:{disabled:"",type:"number"},model:{value:t.orderNumber,callback:function(e){t.orderNumber=e},expression:"orderNumber"}})],1)],1),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{span:12}},[t._v(" СУММА ЗАКАЗА: "),a("div",[t._v(t._s(this.items?t.numberToPrice(t.calcTotalPrice(this.items)):null))])])],1),a("a-row",[a("a-tabs",{staticStyle:{padding:"0 15px"},attrs:{type:"card"},on:{change:t.activeTabHandler},model:{value:t.activeTabKey,callback:function(e){t.activeTabKey=e},expression:"activeTabKey"}},[a("a-tab-pane",{key:"1",attrs:{tab:t.$t("order_data")}},[a("a-row",[a("a-col",{staticStyle:{padding:"0 15px 0 0"},attrs:{span:12}},[a("a-form-model-item",{ref:"status",attrs:{label:t.$t("status"),prop:"status"}},[a("a-select",{on:{change:t.handleStatus},model:{value:t.order.status,callback:function(e){t.$set(t.order,"status",e)},expression:"order.status"}},[a("a-select-option",{attrs:{value:"in-process"}},[t._v(" В обработке ")]),a("a-select-option",{attrs:{value:"cancelled"}},[t._v(" Отменен ")]),a("a-select-option",{attrs:{value:"finished"}},[t._v(" Завершено ")])],1)],1)],1),a("a-col",{staticStyle:{padding:"0 15px 0 0"},attrs:{span:12}},[a("a-form-model-item",{ref:"deliveryMethod",attrs:{label:t.$t("delivery_method"),prop:"deliveryMethod"}},[a("a-select",{on:{change:t.handleDeliveryMethod},model:{value:t.order.delivery_method,callback:function(e){t.$set(t.order,"delivery_method",e)},expression:"order.delivery_method"}},[a("a-select-option",{attrs:{value:"self"}},[t._v(" Самовывоз ")]),a("a-select-option",{attrs:{value:"delivery"}},[t._v(" Доставка в течении дня ")])],1)],1)],1),a("a-col",{staticStyle:{padding:"0 15px 0 0"},attrs:{span:12}},[a("a-form-model-item",{ref:"paymentMethod",attrs:{label:t.$t("payment_method"),prop:"paymentMethod"}},[a("a-select",{on:{change:t.handlePaymentMethod},model:{value:t.order.payment_method,callback:function(e){t.$set(t.order,"payment_method",e)},expression:"order.payment_method"}},[a("a-select-option",{attrs:{value:"cash",disabled:this.isUnired}},[t._v(" Наличные ")]),a("a-select-option",{attrs:{value:"card",disabled:this.isUnired}},[t._v(" Терминал ")]),a("a-select-option",{attrs:{value:"click",disabled:this.isUnired}},[t._v(" Click ")]),a("a-select-option",{attrs:{value:"payme",disabled:this.isUnired}},[t._v(" PayMe ")]),a("a-select-option",{attrs:{value:"unired",disabled:!this.isUnired}},[t._v(" Unired ")])],1)],1)],1),a("a-col",{staticStyle:{padding:"0 15px 0 0"},attrs:{span:12}},[a("a-form-model-item",{ref:"address",attrs:{label:t.$t("address"),prop:"address"}},[a("a-input",{model:{value:t.order.address,callback:function(e){t.$set(t.order,"address",e)},expression:"order.address"}})],1)],1),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{span:24}},[a("a-form-model-item",{ref:"map",attrs:{label:t.$t("map"),prop:"map"}},[a("yandex-map",{staticStyle:{width:"100%","max-width":"1000px",height:"80vh"},attrs:{coords:t.coords,zoom:18},model:{value:t.coords,callback:function(e){t.coords=e},expression:"coords"}},[a("ymap-marker",{attrs:{coords:t.coords,"marker-id":"123","hint-content":"point"}})],1)],1)],1)],1)],1),a("a-tab-pane",{key:"2",attrs:{tab:t.$t("products")}},[a("a-row",[a("a-col",{attrs:{span:24}},[a("a-table",{attrs:{rowKey:function(t){return t.product_id},columns:t.columns,"data-source":t.getProducts,bordered:""},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"price",fn:function(e,a){return[t._v(" "+t._s(t.numberToPrice(a.price))+" ")]}}])})],1)],1)],1),a("a-tab-pane",{key:"3",attrs:{tab:t.$t("customer")}},[a("a-row",[a("a-col",{staticStyle:{padding:"0 15px"},attrs:{span:12}},[a("a-form-model-item",{ref:"customerName",attrs:{label:t.$t("firstName"),prop:"customerName"}},[a("a-input",{model:{value:t.order.customer_name,callback:function(e){t.$set(t.order,"customer_name",e)},expression:"order.customer_name"}})],1)],1),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{span:12}},[a("a-form-model-item",{ref:"phone",attrs:{label:t.$t("phone"),prop:"phone"}},[a("a-input",{attrs:{disabled:""},model:{value:t.order.phone,callback:function(e){t.$set(t.order,"phone",e)},expression:"order.phone"}})],1)],1),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{span:12}},[a("a-form-model-item",{ref:"customerNote",attrs:{label:t.$t("note"),prop:"customerNote"}},[a("a-input",{model:{value:t.order.note,callback:function(e){t.$set(t.order,"note",e)},expression:"order.note"}})],1)],1)],1)],1),a("a-tab-pane",{key:"4",attrs:{tab:t.$t("activities")}},[a("user-activities")],1)],1)],1)],1)],1)},s=[],i=(a("99af"),a("a9e3"),a("ac1f"),a("5319"),a("1276"),a("5530")),c=a("b775"),d=a("bf6b"),l=a("fff2"),u=a("5880"),m=a("be03"),p={components:{"user-activities":m["a"]},data:function(){return{orderNumber:this.$route.params.id,activeTabKey:"1",labelCol:{span:24},wrapperCol:{span:24},loading:!1,coords:[41.31,69.28],items:null,order:{status:"",customer_name:"",address:"",note:"",phone:"",payment_method:"",delivery_method:""},rules:{number:[{required:!0,message:this.$t("required"),trigger:"change"}]},columns:[{title:this.$t("product_name"),dataIndex:"product_name",width:"50%"},{title:this.$t("price"),key:"price",width:"30%",scopedSlots:{customRender:"price"}},{title:this.$t("quantity"),dataIndex:"quantity",width:"20%"}]}},mounted:function(){this.getOrderAttrs(),this.getAdmin().then((function(t){}))},computed:Object(i["a"])(Object(i["a"])({},Object(u["mapGetters"])(["admin"])),{},{getProducts:function(){return this.items},isUnired:function(){return"unired"===this.order.payment_method}}),methods:Object(i["a"])(Object(i["a"])({},Object(u["mapActions"])(["getAdmin"])),{},{getOrderAttrs:function(){var t=this;Object(c["b"])({url:"/order/".concat(this.orderNumber),method:"get"}).then((function(e){var a=e.items,r=e.customer_name,n=e.address,o=e.phone,s=e.note,i=e.status,c=e.longlat,d=e.delivery_method,l=e.payment_method;t.items=a,t.order.customer_name=r,t.order.address=n,t.order.phone=o,t.order.note=s,t.order.status=i,t.order.delivery_method=d,t.order.payment_method=l,t.coords=c?[Number(c.split(",")[0]),Number(c.split(",")[1])]:t.coords}))},numberToPrice:function(t){return Object(d["a"])(t)},calcTotalPrice:function(t){return Object(l["a"])(t)},activeTabHandler:function(t){this.activeTabKey=t},handleTableChange:function(t){},getPagination:function(t){return t},handlePaymentMethod:function(t){this.order.payment_method=t},handleDeliveryMethod:function(t){this.order.delivery_method=t},handleStatus:function(t){this.order.status=t},onSubmit:function(){var t=this;this.$refs.ruleForm.validate((function(e){if(!e)return!1;var a="/order/".concat(t.orderNumber),r="put",n={"Content-Type":"application/json"};Object(c["b"])({url:a,method:r,data:Object(i["a"])(Object(i["a"])({},t.order),{},{longlat:"".concat(t.coords[0],",").concat(t.coords[1]),user_id:t.admin.id}),headers:n}).then((function(e){t.$router.replace("/orders/list")})).catch((function(e){t.$message.error(t.$t("error"))}))}))},resetForm:function(){this.$refs.ruleForm.resetFields()}})},h=p,f=(a("0faf"),a("2877")),b=Object(f["a"])(h,o,s,!1,null,null,null),v=b.exports,g={data:function(){return{}},components:{"v-main":v},methods:{submit:function(){this.$refs.orderDetailsEdit.onSubmit()},resetForm:function(){this.$refs.orderDetailsEdit.resetForm()}}},y=g,_=(a("f169"),Object(f["a"])(y,r,n,!1,null,null,null));e["default"]=_.exports},a386:function(t,e,a){},be03:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-table",{attrs:{columns:t.columns,rowKey:function(t){return t.id},dataSource:t.getAllUserActivities,pagination:t.getUserActivitiesPagination,loading:t.loading,align:"center"},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"action",fn:function(e,r){return[a("div",{staticClass:"activity-container"},[a("span",{domProps:{innerHTML:t._s(t.sortUserActivities(r))}}),a("a-tag",{staticClass:"time",attrs:{color:"blue"}},[t._v(t._s(t.convertISOToLocaleTime(r.time)))])],1)]}}])})},n=[],o=(a("99af"),a("b0c0"),a("d3b7"),a("cc71"),a("5530")),s=a("5880"),i={data:function(){return{orderNumber:this.$route.params.id,loading:!1,columns:[{title:this.$t("activities"),key:"action",scopedSlots:{customRender:"action"}}],paymentMethods:{cash:"Наличные",card:"Терминал",click:"Click",payme:"Payme",unired:"Unired"},orderStatus:{"in-process":"В обработке",finished:"Завершено",cancelled:"Отменен"}}},methods:Object(o["a"])(Object(o["a"])({},Object(s["mapActions"])(["getUserActivities"])),{},{handleTableChange:function(t){var e=this;this.loading=!0,this.getUserActivities({page:t,orderNumber:this.orderNumber}).then((function(t){})).catch((function(t){e.$message.error(e.$t("error"))})).finally((function(){return e.loading=!1}))},sortUserActivities:function(t){var e=t.action,a=t.user.name,r=t.from_value,n=t.to_value;switch(e){case"change-status":return"Пользователь ".concat(a.bold()," изменил статус с ").concat(this.textChanger(r,e)," на ").concat(this.textChanger(n,e));case"change-payment-method":return"Пользователь ".concat(a.bold()," изменил способ оплаты с ").concat(this.textChanger(r,e)," на ").concat(this.textChanger(n,e));case"change-address":return"Пользователь ".concat(a.bold()," изменил адрес с ").concat(r.bold()," на ").concat(n.bold());case"change-customer-name":return"Пользователь ".concat(a.bold()," изменил имя клиента с ").concat(r.bold()," на ").concat(n.bold());case"change-note":return"Пользователь ".concat(a.bold()," изменил комментарий на ").concat(n.bold());default:return t}},convertISOToLocaleTime:function(t){return new Date(t).toLocaleString("uz-UZ")},textChanger:function(t,e){switch(e){case"change-payment-method":return this.paymentMethods[t].bold();case"change-status":return this.orderStatus[t].bold();default:return t}}}),computed:Object(o["a"])(Object(o["a"])({},Object(s["mapGetters"])(["userActivities","userActivitiesPagination"])),{},{getAllUserActivities:function(){return this.userActivities},getUserActivitiesPagination:function(){return this.userActivitiesPagination}}),mounted:function(){var t=this;this.loading=!0,this.getUserActivities({page:null,orderNumber:this.orderNumber}).then((function(t){})).catch((function(t){})).finally((function(){return t.loading=!1}))}},c=i,d=(a("e62f"),a("2877")),l=Object(d["a"])(c,r,n,!1,null,"1a440624",null);e["a"]=l.exports},bf6b:function(t,e,a){"use strict";a.d(e,"a",(function(){return r}));a("d3b7"),a("ac1f"),a("25f0"),a("5319");function r(t){return"".concat(t.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")," сум")}},c1af:function(t,e,a){},d82f:function(t,e,a){},e62f:function(t,e,a){"use strict";var r=a("c1af"),n=a.n(r);n.a},f169:function(t,e,a){"use strict";var r=a("a386"),n=a.n(r);n.a},fff2:function(t,e,a){"use strict";a.d(e,"a",(function(){return r}));a("13d5");function r(t){return t?t.reduce((function(t,e){return t+=e.quantity*e.price,t}),0):0}}}]);