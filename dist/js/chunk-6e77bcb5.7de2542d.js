(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6e77bcb5"],{"17c9":function(t,e,a){},"5e5d":function(t,e,a){},"8aff":function(t,e,a){"use strict";var r=a("17c9"),i=a.n(r);i.a},b017:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("editor",t._g(t._b({attrs:{inline:"","api-key":"jz9zw066y1twsoyxdauivnsw1soymo6l7vi9om94g7ijszt4",initialValue:"",init:{selector:"textarea#image-tools",height:500,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste imagetools wordcount"],toolbar:"insertfile undo redo | styleselect | fontsizeselect bold italic | image media | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link",image_title:!0,automatic_uploads:!0,file_picker_types:"image",file_picker_callback:this.uploader,content_style:"body { font-family:Helvetica,Arial,sans-serif; font-size:14px }"}}},"editor",t.$attrs,!1),t.$listeners))},i=[],o=(a("b0c0"),a("ac1f"),a("1276"),a("ca72")),l={name:"TinyEditor",components:{editor:o["a"]},data:function(){return{useDarkMode:window.matchMedia("(prefers-color-scheme: dark)").matches,document:document}},methods:{uploader:function(t,e,a){var r=document.createElement("input");r.setAttribute("type","file"),r.setAttribute("accept","image/*"),r.onchange=function(){var e=this.files[0],a=new FileReader;a.onload=function(){var r="blobid"+(new Date).getTime(),i=window.tinymce.activeEditor.editorUpload.blobCache,o=a.result.split(",")[1],l=i.create(r,e,o);i.add(l),t(l.blobUri(),{title:e.name})},a.readAsDataURL(e)},r.click()}}},n=l,s=a("2877"),m=Object(s["a"])(n,r,i,!1,null,null,null);e["a"]=m.exports},bd44:function(t,e,a){"use strict";var r=a("5e5d"),i=a.n(r);i.a},cf01:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-row",[a("a-col",{attrs:{span:12}},[a("a-breadcrumb",{staticStyle:{margin:"10px 5px"}},[a("a-breadcrumb-item",[a("router-link",{attrs:{to:"/promos/list"}},[t._v(t._s(t.$t("promos")))])],1),a("a-breadcrumb-item",[t._v(t._s(t.$t("add")))])],1)],1)],1),t.edit?a("div",[a("a-card",{attrs:{title:t.$t("fillIn")}},[a("a-row",[a("a-tabs",{attrs:{type:"card"},model:{value:t.activeTabKey,callback:function(e){t.activeTabKey=e},expression:"activeTabKey"}},[a("a-tab-pane",{key:"1"},[a("span",{attrs:{slot:"tab"},slot:"tab"},[a("flag",{attrs:{iso:"ru"}}),t._v(" Русский ")],1),a("v-main",{ref:"ruEditForm",attrs:{lang:"ru"}})],1),a("a-tab-pane",{key:"2"},[a("span",{attrs:{slot:"tab"},slot:"tab"},[a("flag",{attrs:{iso:"uz"}}),t._v(" O'zbekcha ")],1),a("v-main",{ref:"uzEditForm",attrs:{lang:"uz"}})],1)],1)],1)],1)],1):a("div",[a("a-card",{attrs:{title:t.$t("fillIn")}},[a("a-row",[a("v-main",{ref:"createForm"})],1)],1)],1),a("a-row",[a("a-col",{staticStyle:{padding:"15px 0"},attrs:{span:24}},[a("a-form-model-item",[a("a-button",{attrs:{type:"primary","html-type":"submit"},on:{click:function(e){return e.preventDefault(),t.submit(e)}}},[t._v(" "+t._s(t.$t("save"))+" ")]),a("a-button",{staticStyle:{"margin-left":"10px"},on:{click:function(e){return e.preventDefault(),t.resetForm(e)}}},[t._v(" "+t._s(t.$t("reset"))+" ")])],1)],1)],1)],1)},i=[],o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-switch",{staticStyle:{margin:"15px 0"},attrs:{slot:"extra","checked-children":t.$t("active"),"un-checked-children":t.$t("inactive"),"default-checked":""},slot:"extra",model:{value:t.promo.active,callback:function(e){t.$set(t.promo,"active",e)},expression:"promo.active"}}),a("a-form-model",{ref:"ruleForm",attrs:{model:t.promo,rules:t.rules,"label-col":t.labelCol,"wrapper-col":t.wrapperCol},on:{submit:t.onSubmit}},[a("a-tabs",{attrs:{type:"card"},on:{change:t.activeTabHandler},model:{value:t.activeTabKey,callback:function(e){t.activeTabKey=e},expression:"activeTabKey"}},[a("a-tab-pane",{key:"1",attrs:{tab:t.$t("basicSettings")}},[a("a-row",[a("a-col",{staticStyle:{padding:"0 15px"},attrs:{span:12}},[a("a-form-model-item",{ref:"title",attrs:{label:t.$t("title"),prop:"title"}},[a("a-input",{model:{value:t.promo.title,callback:function(e){t.$set(t.promo,"title",e)},expression:"promo.title"}})],1)],1),this.promoSlug?a("a-col",{staticStyle:{padding:"0 15px"},attrs:{span:12}},[a("a-form-model-item",{ref:"url",attrs:{label:t.$t("url"),prop:"url"}},[a("a-input",{attrs:{disabled:""},model:{value:t.promoSlug,callback:function(e){t.promoSlug=e},expression:"promoSlug"}})],1)],1):t._e(),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{span:24}},[a("a-form-model-item",{ref:"date",attrs:{label:t.$t("date"),prop:"url"}},[a("a-range-picker",{ref:"piker",attrs:{locale:t.locale,size:"large",showTime:""},on:{change:t.onDateChange},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1)],1),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{span:24}},[a("a-form-model-item",{ref:"description",attrs:{label:t.$t("description"),prop:"description"}},[a("tinymce",{model:{value:t.promo.description,callback:function(e){t.$set(t.promo,"description",e)},expression:"promo.description"}})],1)],1),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{span:24}},[a("a-form-model-item",{ref:"fullText",attrs:{label:t.$t("full_text"),prop:"fullText"}},[a("tinymce",{model:{value:t.promo.preview_text,callback:function(e){t.$set(t.promo,"preview_text",e)},expression:"promo.preview_text"}})],1)],1)],1)],1),a("a-tab-pane",{key:"2",attrs:{tab:t.$t("images")}},[a("a-row",[a("a-col",{style:{minHeight:"180px",padding:"0 15px"},attrs:{span:24}},[a("a-form-item",{attrs:{label:t.$t("uploadImage")}},[a("a-upload",{staticClass:"avatar-uploader",attrs:{"custom-request":t.uploadImage,"list-type":"picture-card","show-upload-list":!1,"before-upload":t.beforeUpload}},[t.imageUrl?a("img",{attrs:{src:t.imageUrl,alt:"avatar"}}):a("div",[a("a-icon",{attrs:{type:t.loading?"loading":"plus"}}),a("div",{staticClass:"ant-upload-text"},[t._v(" "+t._s(t.$t("uploadImage"))+" ")])],1)])],1)],1),a("a-col",{style:{minHeight:"180px",padding:"0 15px"},attrs:{span:24}},[a("a-form-item",{attrs:{label:t.$t("uploadPreviewImage")}},[a("a-upload",{staticClass:"avatar-uploader",attrs:{"custom-request":t.uploadPreviewImage,"list-type":"picture-card","show-upload-list":!1,"before-upload":t.beforeUpload}},[t.previewImageUrl?a("img",{attrs:{src:t.previewImageUrl,alt:"avatar"}}):a("div",[a("a-icon",{attrs:{type:t.loading?"loading":"plus"}}),a("div",{staticClass:"ant-upload-text"},[t._v(" "+t._s(t.$t("uploadPreviewImage"))+" ")])],1)])],1)],1)],1)],1),a("a-tab-pane",{key:"3",attrs:{tab:t.$t("SEO")}},[a("a-row",[a("a-col",{staticStyle:{padding:"0 15px"},attrs:{md:24,lg:8}},[a("a-form-model-item",{ref:"meta_title",attrs:{label:t.$t("meta_title"),prop:"meta_title"}},[a("a-input",{model:{value:t.promo.meta.title,callback:function(e){t.$set(t.promo.meta,"title",e)},expression:"promo.meta.title"}})],1)],1),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{md:24,lg:8}},[a("a-form-model-item",{ref:"meta_desc",attrs:{label:t.$t("meta_description"),prop:"meta_desc"}},[a("a-input",{model:{value:t.promo.meta.description,callback:function(e){t.$set(t.promo.meta,"description",e)},expression:"promo.meta.description"}})],1)],1),a("a-col",{staticStyle:{padding:"0 15px"},attrs:{md:24,lg:8}},[a("a-form-model-item",{ref:"meta_tags",attrs:{label:t.$t("meta_tags"),prop:"meta_tags"}},[a("a-input",{model:{value:t.promo.meta.tags,callback:function(e){t.$set(t.promo.meta,"tags",e)},expression:"promo.meta.tags"}})],1)],1)],1)],1)],1)],1)],1)},l=[],n=(a("a4d3"),a("e01a"),a("99af"),a("ac1f"),a("5319"),a("1276"),a("5530")),s=a("b017"),m=a("b775"),c=a("c4ee"),p=a("c1df"),u=a.n(p);function d(t){var e=new Date(t),a=e.getFullYear(),r=e.getMonth()+1,i=e.getDate(),o=e.getHours(),l=e.getMinutes(),n=e.getSeconds();return f(a,r,i,o,l,n)}function f(t,e,a,r,i,o){return g(t)+"-"+g(e)+"-"+g(a)+" "+g(r)+":"+g(i)+":"+g(o)}function g(t){return t<10?"0"+t:t}var b="YYYY-MM-DD HH:mm:ss";function v(t,e){var a=new FileReader;a.addEventListener("load",(function(){return e(a.result)})),a.readAsDataURL(t)}var h={components:{tinymce:s["a"]},props:{lang:String},data:function(){return{activeTabKey:"1",promoSlug:this.$route.params.id,labelCol:{span:24},wrapperCol:{span:24},other:"",loading:!1,imageUrl:"",previewImageUrl:"",date:[],promo:{title:"",description:"",image:"",preview_image:"",preview_text:"",start_time:null,end_time:null,active:!0,meta:{title:"",description:"",tags:""}},rules:{title:[{required:!0,message:this.$t("required"),trigger:"change"}],order:[{required:!0,message:this.$t("required"),trigger:"change"}],resource:[{required:!0,message:"Please select activity resource",trigger:"change"}],desc:[{required:!0,message:"Please input activity form",trigger:"blur"}]},locale:c["a"]}},created:function(){this.promoSlug&&this.getPromoAttrs(this.promoSlug)},methods:{getPromoAttrs:function(){var t=this;Object(m["b"])({url:"/promo/".concat(this.promoSlug,"?lang=").concat(this.lang),method:"get"}).then((function(e){var a=e.promo,r=a.title,i=a.description,o=a.active,l=a.start_time,n=a.end_time,s=a.preview_image,m=a.image,c=a.meta,p=a.preview_text;t.promo.title=r,t.promo.description=i,t.promo.active=o,t.promo.meta=c,t.promo.preview_text=p,t.promo.start_time=d(l),t.promo.end_time=d(n),t.date[0]=u()(t.promo.start_time,b),t.date[1]=u()(t.promo.end_time,b),t.promo.preview_image=s.split("/")[4]||"",t.promo.image=m.split("/")[4]||"",t.imageUrl=m,t.previewImageUrl=s}))},uploadImage:function(t){var e=this;this.loading=!0;var a=new FormData;a.append("file",t.file),Object(m["b"])({url:"/upload",method:"post",data:a}).then((function(a){v(t.file,(function(t){e.imageUrl=t,e.loading=!1})),e.promo.image=a.filename}))},uploadPreviewImage:function(t){var e=this;this.loading=!0;var a=new FormData;a.append("file",t.file),Object(m["b"])({url:"/upload",method:"post",data:a}).then((function(a){v(t.file,(function(t){e.previewImageUrl=t,e.loading=!1})),e.promo.preview_image=a.filename}))},beforeUpload:function(t){var e="image/jpeg"===t.type||"image/png"===t.type;return e||this.$message.error("You can only upload JPG, PNG file!"),e},onReady:function(t){t.ui.getEditableElement().parentElement.insertBefore(t.ui.view.toolbar.element,t.ui.getEditableElement())},onDateChange:function(t,e){t.length&&(this.promo.start_time=e[0]||"",this.promo.end_time=e[1]||"")},onSubmit:function(){var t=this;this.$refs.ruleForm.validate((function(e){if(!e)return!1;var a,r="/promo",i="post";t.promoSlug&&(r="/promo/".concat(t.promoSlug),i="put");var o={"Content-Type":"application/json"};Object(m["b"])({url:r,method:i,data:Object(n["a"])(Object(n["a"])({},t.promo),{},{start_time:new Date(t.promo.start_time).toUTCString(),end_time:new Date(t.promo.end_time).toUTCString(),lang:null!==(a=t.lang)&&void 0!==a?a:"ru"}),headers:o}).then((function(e){t.$router.replace("/promos")})).then((function(e){e&&t.$message.success(t.$t("error"))}))}))},resetForm:function(){this.$refs.ruleForm.resetFields()},activeTabHandler:function(t){this.activeTabKey=t}}},_=h,y=(a("bd44"),a("2877")),w=Object(y["a"])(_,o,l,!1,null,null,null),$=w.exports,x={data:function(){return{activeTabKey:"1",edit:!!this.$route.params.id}},mounted:function(){},updated:function(){},methods:{submit:function(){if(this.edit){if(!this.$refs.uzEditForm)return void this.$refs.ruEditForm.onSubmit();this.$refs.ruEditForm.onSubmit(),this.$refs.uzEditForm.onSubmit()}else this.$refs.createForm.onSubmit()},resetForm:function(){if(this.edit){if(!this.$refs.uzEditForm)return void this.$refs.ruEditForm.resetForm();this.$refs.ruEditForm.resetForm(),this.$refs.uzEditForm.resetForm()}else this.$refs.createForm.resetForm()}},components:{"v-main":$}},k=x,S=(a("8aff"),Object(y["a"])(k,r,i,!1,null,null,null));e["default"]=S.exports}}]);